SRCS    =       main.c tree.c io.c particle.c sfc.c parallel.c \
                cell_buffer.c iterators.c index_hash.c   \
                load_balance.c timestep.c density.c viewdump.c \
                tree_count.c tree_debug.c tree_alloc.c tree_interpolate.c tree_arrays.c \
                refinement.c refinement_indicators.c refinement_operations.c \
                timing.c tree_linkedlist.c hydro.c units.c riemann.c gravity.c \
                poisson.c auxiliary.c skiplist.c pack.c config.c logging.c \
		cooling.c starformation.c cache.c analysis.c analysis_xray.c power.c hydro_tracer.c 
                                                                                                                                                            
OBJS    =	$(patsubst %.c,.obj/%.o,$(SRCS))
LIBS    =  -lgsl -lgslcblas -lm -lsrfftw -lsfftw 

.obj:
	mkdir .obj

.obj/%.o: defs.h $(SRC_DIR)/%.c
	$(CC) -c $(CFLAGS) $(INCLUDES) -I. -I$(SRC_DIR) -o $@ $(SRC_DIR)/$(*F).c

# COMPILE OPTIONS

# lyra (any gcc)
#CFLAGS  = -O3 -funroll-loops -finline-functions -Wall -m64 -mcmodel=medium
#CC      = mpicc
#F77     = mpif77
#INCLUDES=-I/home/drudd/include -L/home/drudd/lib/
#EXTRALIBS=-lm

# jet, mandor (intel compiler)
CFLAGS  = -O2 -xW -w1 -ipo -fno-alias -unroll -mcmodel=large -i_dynamic 
CC      = mpicc
F77     = mpif77
INCLUDES=-I/home/drudd/include -L/home/drudd/lib/

# draco (icc)
#CFLAGS  = -O3 -w1 -ipo -ansi_alias
#CC      = mpicc
#F77     = mpif77
#INCLUDES= 

# ghostwheel (ecc)
#CFLAGS = -O2 -w1 -ipo
#CC      = mpicc
#F77     = mpif77

# cu (ibm)
#CFLAGS  = -bmaxdata:0x80000000
#CC     = mpcc
#F77    = mpxlf

# columbia (altix)
#CFLAGS  	= -O2 -w1 -ipo -unroll -fno-alias -ansi_alias
#EXTRALIBS	= -lmpi
#CC      	= icc
#F77     	= ifort
#INCLUDES 	= -L/u/drudd/lib/ -I/u/drudd/include/ -L/opt/sgi/mpt/1.9.1.0/lib

# jacquard (pathscale compiler)
#CFLAGS  	= -O2
#EXTRALIBS	= -lm
#CC      	= mpicc
#INCLUDES	= ${FFTW} -I/u1/drudd/include/ -L/u1/drudd/lib/

# cobalt (altix)
#CFLAGS          = -O2 -w1 -ipo -unroll -fno-alias -ansi_alias
#EXTRALIBS      = -lmpi
#CC             = icc
#F77            = ifort
#INCLUDES       = -I${FFTW_HOME}/include -L${FFTW_HOME}/lib -I${GSL_HOME}/include -L${GSL_HOME}/lib
